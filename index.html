<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Background Remover - No Limit</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
        }

        .container { max-width: 900px; margin: 0 auto; }

        h1 {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 8px;
            background: linear-gradient(90deg, #00d4ff, #7b2dff, #ff2d7c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle { text-align: center; color: #666; margin-bottom: 30px; }

        .card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
        }

        /* Tabs */
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }

        .tab {
            flex: 1;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            color: #888;
            cursor: pointer;
            text-align: center;
            transition: 0.3s;
        }

        .tab:hover { background: rgba(255,255,255,0.08); }
        .tab.active {
            background: linear-gradient(135deg, #7b2dff, #00d4ff);
            color: #fff;
            border-color: transparent;
        }

        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Upload */
        .upload-zone {
            border: 2px dashed rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 50px 20px;
            text-align: center;
            cursor: pointer;
            transition: 0.3s;
        }

        .upload-zone:hover {
            border-color: #00d4ff;
            background: rgba(0,212,255,0.05);
        }

        .upload-zone.dragover {
            border-color: #7b2dff;
            background: rgba(123,45,255,0.1);
        }

        .upload-icon { font-size: 3rem; margin-bottom: 10px; }
        #fileInput { display: none; }

        /* Settings */
        .settings-row {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .setting-item {
            flex: 1;
            min-width: 150px;
            background: rgba(0,0,0,0.2);
            padding: 12px;
            border-radius: 8px;
        }

        .setting-item label {
            display: block;
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 5px;
        }

        .setting-item select, .setting-item input {
            width: 100%;
            padding: 8px;
            border-radius: 6px;
            border: 1px solid rgba(255,255,255,0.1);
            background: rgba(0,0,0,0.3);
            color: #fff;
        }

        /* Progress */
        .progress-section {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.1);
            border-top-color: #00d4ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .progress-bar-container {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            height: 8px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #7b2dff, #00d4ff);
            width: 0%;
            transition: width 0.3s;
        }

        .progress-text { color: #888; font-size: 0.9rem; }

        /* Result */
        .result-section { display: none; }

        .compare-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        @media (max-width: 600px) {
            .compare-grid { grid-template-columns: 1fr; }
        }

        .img-box {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            background: repeating-conic-gradient(#222 0% 25%, #2a2a2a 0% 50%) 50% / 15px 15px;
            min-height: 200px;
        }

        .img-box img { width: 100%; display: block; }

        .img-label {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.8rem;
        }

        .img-info {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            color: #00d4ff;
        }

        /* Buttons */
        .btn-group { display: flex; gap: 10px; flex-wrap: wrap; }

        .btn {
            flex: 1;
            min-width: 150px;
            padding: 14px 20px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #7b2dff, #00d4ff);
            color: #fff;
        }

        .btn-success {
            background: linear-gradient(135deg, #00c853, #00e676);
            color: #000;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }

        .btn:hover { transform: translateY(-2px); }

        /* Chroma Key Controls */
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .control-item label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85rem;
            color: #aaa;
        }

        .control-item input[type="range"] {
            width: 100%;
            accent-color: #7b2dff;
        }

        .color-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        #colorPicker {
            width: 50px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        #colorHex {
            flex: 1;
            padding: 10px;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: #fff;
            font-family: monospace;
        }

        .picker-canvas {
            max-width: 100%;
            max-height: 350px;
            border-radius: 8px;
            cursor: crosshair;
            display: none;
            margin: 15px auto;
            border: 2px solid #333;
        }

        /* Alert */
        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: none;
            font-size: 0.9rem;
        }

        .alert-error {
            background: rgba(255,45,124,0.1);
            border: 1px solid rgba(255,45,124,0.3);
            color: #ff6b9d;
        }

        .alert-warning {
            background: rgba(255,193,7,0.1);
            border: 1px solid rgba(255,193,7,0.3);
            color: #ffc107;
        }

        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ú® Background Remover Pro</h1>
        <p class="subtitle">Hapus background - Tanpa batas ukuran file</p>

        <div class="alert alert-error" id="alertError"></div>
        <div class="alert alert-warning" id="alertWarning"></div>

        <div class="card">
            <!-- Tabs -->
            <div class="tabs">
                <div class="tab active" onclick="switchTab('ai')">ü§ñ Mode AI</div>
                <div class="tab" onclick="switchTab('manual')">üé® Mode Manual</div>
            </div>

            <!-- Upload Zone -->
            <div class="upload-zone" id="uploadZone">
                <div class="upload-icon">üìÅ</div>
                <h3>Klik atau Drop Foto Disini</h3>
                <p style="color:#666; margin-top:8px;">JPG, PNG, WebP - <strong>Tanpa Batas Ukuran</strong></p>
                <input type="file" id="fileInput" accept="image/*">
            </div>

            <!-- Settings -->
            <div class="settings-row" id="settingsRow">
                <div class="setting-item">
                    <label>üìê Resolusi Output</label>
                    <select id="outputSize">
                        <option value="original">Original (Full Quality)</option>
                        <option value="4000">Max 4000px (Recommended)</option>
                        <option value="2000" selected>Max 2000px (Fast)</option>
                        <option value="1000">Max 1000px (Very Fast)</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label>üñºÔ∏è Format Output</label>
                    <select id="outputFormat">
                        <option value="png" selected>PNG (Transparent)</option>
                        <option value="webp">WebP (Smaller Size)</option>
                    </select>
                </div>
            </div>

            <!-- Progress -->
            <div class="progress-section" id="progressSection">
                <div class="spinner"></div>
                <p class="progress-text" id="progressText">Memproses...</p>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="progressBar"></div>
                </div>
                <p style="color:#555; font-size:0.8rem; margin-top:10px;">
                    File besar mungkin butuh waktu lebih lama
                </p>
            </div>

            <!-- Manual Tab -->
            <div class="tab-content" id="tabManual">
                <p style="color:#888; font-size:0.9rem; margin-bottom:15px;">
                    üí° Klik pada gambar untuk memilih warna background
                </p>
                <canvas id="pickerCanvas" class="picker-canvas"></canvas>
                
                <div class="controls-grid hidden" id="manualControls">
                    <div class="control-item">
                        <label>Warna Target</label>
                        <div class="color-row">
                            <input type="color" id="colorPicker" value="#00ff00">
                            <input type="text" id="colorHex" value="#00ff00">
                        </div>
                    </div>
                    <div class="control-item">
                        <label>Toleransi <span id="tolVal">35</span></label>
                        <input type="range" id="tolerance" min="1" max="150" value="35">
                    </div>
                    <div class="control-item">
                        <label>Kehalusan <span id="softVal">15</span></label>
                        <input type="range" id="softness" min="0" max="50" value="15">
                    </div>
                    <div class="control-item">
                        <label>Despill <span id="despillVal">50</span></label>
                        <input type="range" id="despill" min="0" max="100" value="50">
                    </div>
                </div>
                
                <div class="btn-group hidden" id="manualButtons" style="margin-top:15px;">
                    <button class="btn btn-primary" onclick="processManual()">‚ö° Hapus Background</button>
                </div>
            </div>

            <!-- AI Tab -->
            <div class="tab-content active" id="tabAI"></div>

            <!-- Result -->
            <div class="result-section" id="resultSection">
                <div class="compare-grid">
                    <div class="img-box">
                        <span class="img-label">üì∑ Original</span>
                        <img id="originalImg" alt="Original">
                        <span class="img-info" id="originalInfo"></span>
                    </div>
                    <div class="img-box">
                        <span class="img-label">‚úÖ Hasil</span>
                        <img id="resultImg" alt="Result">
                        <span class="img-info" id="resultInfo"></span>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn btn-success" onclick="downloadResult()">üì• Download</button>
                    <button class="btn btn-secondary" onclick="resetAll()">üîÑ Foto Baru</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden Canvases -->
    <canvas id="workCanvas" class="hidden"></canvas>
    <canvas id="outputCanvas" class="hidden"></canvas>

    <script type="module">
        import { pipeline, env } from 'https://cdn.jsdelivr.net/npm/@huggingface/transformers@3.0.0';
        
        env.allowLocalModels = false;
        env.useBrowserCache = true;

        // ============ VARIABLES ============
        let currentMode = 'ai';
        let currentFile = null;
        let originalImageData = null;
        let segmenter = null;
        let resultBlob = null;

        // DOM
        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');
        const progressSection = document.getElementById('progressSection');
        const progressText = document.getElementById('progressText');
        const progressBar = document.getElementById('progressBar');
        const resultSection = document.getElementById('resultSection');
        const originalImg = document.getElementById('originalImg');
        const resultImg = document.getElementById('resultImg');
        const alertError = document.getElementById('alertError');
        const alertWarning = document.getElementById('alertWarning');
        const settingsRow = document.getElementById('settingsRow');

        const pickerCanvas = document.getElementById('pickerCanvas');
        const pickerCtx = pickerCanvas.getContext('2d');
        const workCanvas = document.getElementById('workCanvas');
        const workCtx = workCanvas.getContext('2d');
        const outputCanvas = document.getElementById('outputCanvas');
        const outputCtx = outputCanvas.getContext('2d');

        // ============ EVENTS ============
        
        uploadZone.onclick = () => fileInput.click();
        
        uploadZone.ondragover = (e) => {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        };
        
        uploadZone.ondragleave = () => uploadZone.classList.remove('dragover');
        
        uploadZone.ondrop = (e) => {
            e.preventDefault();
            uploadZone.classList.remove('dragover');
            handleFile(e.dataTransfer.files[0]);
        };
        
        fileInput.onchange = (e) => handleFile(e.target.files[0]);

        // Color sync
        document.getElementById('colorPicker').oninput = (e) => {
            document.getElementById('colorHex').value = e.target.value;
        };
        
        document.getElementById('colorHex').onchange = (e) => {
            if (/^#[0-9A-Fa-f]{6}$/.test(e.target.value)) {
                document.getElementById('colorPicker').value = e.target.value;
            }
        };

        // Range displays
        ['tolerance', 'softness', 'despill'].forEach(id => {
            document.getElementById(id).oninput = (e) => {
                document.getElementById(id.slice(0,3) + (id === 'despill' ? 'pillVal' : 'Val')).textContent = e.target.value;
            };
        });
        
        document.getElementById('tolerance').oninput = (e) => document.getElementById('tolVal').textContent = e.target.value;
        document.getElementById('softness').oninput = (e) => document.getElementById('softVal').textContent = e.target.value;
        document.getElementById('despill').oninput = (e) => document.getElementById('despillVal').textContent = e.target.value;

        // Canvas color picker
        pickerCanvas.onclick = (e) => {
            const rect = pickerCanvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) * (pickerCanvas.width / rect.width);
            const y = (e.clientY - rect.top) * (pickerCanvas.height / rect.height);
            const pixel = pickerCtx.getImageData(x, y, 1, 1).data;
            const hex = '#' + [pixel[0], pixel[1], pixel[2]].map(x => x.toString(16).padStart(2, '0')).join('');
            document.getElementById('colorPicker').value = hex;
            document.getElementById('colorHex').value = hex;
        };

        // ============ FUNCTIONS ============

        window.switchTab = function(mode) {
            currentMode = mode;
            document.querySelectorAll('.tab').forEach((t, i) => {
                t.classList.toggle('active', (i === 0 && mode === 'ai') || (i === 1 && mode === 'manual'));
            });
            document.getElementById('tabAI').classList.toggle('active', mode === 'ai');
            document.getElementById('tabManual').classList.toggle('active', mode === 'manual');
            
            if (currentFile && mode === 'manual') {
                loadForManual(currentFile);
            }
        };

        function handleFile(file) {
            if (!file || !file.type.startsWith('image/')) {
                showError('Pilih file gambar yang valid');
                return;
            }

            hideAlerts();
            currentFile = file;

            // Show warning for very large files
            if (file.size > 20 * 1024 * 1024) {
                showWarning(`File besar (${(file.size/1024/1024).toFixed(1)}MB) - proses mungkin lambat`);
            }

            originalImg.src = URL.createObjectURL(file);
            document.getElementById('originalInfo').textContent = `${(file.size/1024/1024).toFixed(2)} MB`;

            if (currentMode === 'ai') {
                processAI(file);
            } else {
                loadForManual(file);
            }
        }

        async function processAI(file) {
            showProgress('Menyiapkan...');

            try {
                // Resize image if needed
                const maxSize = parseInt(document.getElementById('outputSize').value) || 2000;
                const processedBlob = await resizeImage(file, maxSize);
                
                updateProgress(10, 'Memuat model AI...');
                
                if (!segmenter) {
                    segmenter = await pipeline('image-segmentation', 'Xenova/modnet', {
                        progress_callback: (p) => {
                            if (p.status === 'downloading') {
                                const pct = Math.round((p.loaded / p.total) * 30);
                                updateProgress(10 + pct, `Download model: ${pct}%`);
                            }
                        }
                    });
                }

                updateProgress(45, 'Menganalisis gambar...');
                
                const imageUrl = URL.createObjectURL(processedBlob);
                const result = await segmenter(imageUrl);
                
                updateProgress(70, 'Menerapkan mask...');

                if (result?.[0]?.mask) {
                    const maskBlob = await result[0].mask.toBlob();
                    await applyMask(processedBlob, maskBlob);
                    updateProgress(100, 'Selesai!');
                    showResult();
                } else {
                    throw new Error('Gagal membuat mask');
                }

            } catch (err) {
                console.error(err);
                hideProgress();
                showError(`Error AI: ${err.message}. Coba Mode Manual.`);
            }
        }

        async function resizeImage(file, maxSize) {
            return new Promise((resolve) => {
                if (maxSize === 'original' || !maxSize) {
                    resolve(file);
                    return;
                }

                const img = new Image();
                img.onload = () => {
                    let { width, height } = img;
                    
                    if (width <= maxSize && height <= maxSize) {
                        resolve(file);
                        return;
                    }

                    const ratio = Math.min(maxSize / width, maxSize / height);
                    width = Math.round(width * ratio);
                    height = Math.round(height * ratio);

                    const canvas = document.createElement('canvas');
                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);

                    canvas.toBlob(resolve, 'image/png', 0.95);
                };
                img.src = URL.createObjectURL(file);
            });
        }

        async function applyMask(originalBlob, maskBlob) {
            return new Promise((resolve) => {
                const origImg = new Image();
                const maskImg = new Image();
                let loaded = 0;

                const onBothLoaded = () => {
                    if (++loaded < 2) return;

                    outputCanvas.width = origImg.width;
                    outputCanvas.height = origImg.height;
                    
                    outputCtx.drawImage(origImg, 0, 0);
                    const imgData = outputCtx.getImageData(0, 0, outputCanvas.width, outputCanvas.height);

                    const tempCanvas = document.createElement('canvas');
                    tempCanvas.width = origImg.width;
                    tempCanvas.height = origImg.height;
                    const tempCtx = tempCanvas.getContext('2d');
                    tempCtx.drawImage(maskImg, 0, 0, origImg.width, origImg.height);
                    const maskData = tempCtx.getImageData(0, 0, tempCanvas.width, tempCanvas.height);

                    for (let i = 0; i < imgData.data.length; i += 4) {
                        imgData.data[i + 3] = maskData.data[i];
                    }

                    outputCtx.putImageData(imgData, 0, 0);

                    const format = document.getElementById('outputFormat').value;
                    const mime = format === 'webp' ? 'image/webp' : 'image/png';
                    
                    outputCanvas.toBlob((blob) => {
                        resultBlob = blob;
                        resultImg.src = URL.createObjectURL(blob);
                        document.getElementById('resultInfo').textContent = 
                            `${outputCanvas.width}x${outputCanvas.height} ‚Ä¢ ${(blob.size/1024).toFixed(0)}KB`;
                        resolve();
                    }, mime, 0.95);
                };

                origImg.onload = onBothLoaded;
                maskImg.onload = onBothLoaded;
                origImg.src = URL.createObjectURL(originalBlob);
                maskImg.src = URL.createObjectURL(maskBlob);
            });
        }

        function loadForManual(file) {
            const img = new Image();
            img.onload = () => {
                const maxSize = parseInt(document.getElementById('outputSize').value) || 2000;
                let { width, height } = img;
                
                if (maxSize !== 'original' && (width > maxSize || height > maxSize)) {
                    const ratio = Math.min(maxSize / width, maxSize / height);
                    width = Math.round(width * ratio);
                    height = Math.round(height * ratio);
                }

                // Picker canvas (smaller for display)
                const displayMax = 500;
                const displayRatio = Math.min(1, displayMax / Math.max(width, height));
                pickerCanvas.width = width * displayRatio;
                pickerCanvas.height = height * displayRatio;
                pickerCtx.drawImage(img, 0, 0, pickerCanvas.width, pickerCanvas.height);

                // Work canvas (full size)
                workCanvas.width = width;
                workCanvas.height = height;
                workCtx.drawImage(img, 0, 0, width, height);
                originalImageData = workCtx.getImageData(0, 0, width, height);

                outputCanvas.width = width;
                outputCanvas.height = height;

                uploadZone.style.display = 'none';
                settingsRow.style.display = 'none';
                pickerCanvas.style.display = 'block';
                document.getElementById('manualControls').classList.remove('hidden');
                document.getElementById('manualButtons').classList.remove('hidden');
            };
            img.src = URL.createObjectURL(file);
        }

        window.processManual = function() {
            const target = hexToRgb(document.getElementById('colorPicker').value);
            const tolerance = parseInt(document.getElementById('tolerance').value);
            const softness = parseInt(document.getElementById('softness').value);
            const despill = parseInt(document.getElementById('despill').value) / 100;

            const output = new ImageData(
                new Uint8ClampedArray(originalImageData.data),
                originalImageData.width,
                originalImageData.height
            );
            const data = output.data;

            for (let i = 0; i < data.length; i += 4) {
                const r = data[i], g = data[i+1], b = data[i+2];
                const dist = Math.sqrt((r-target.r)**2 + (g-target.g)**2 + (b-target.b)**2);

                let alpha = 255;
                if (dist < tolerance) {
                    alpha = 0;
                } else if (dist < tolerance + softness) {
                    alpha = ((dist - tolerance) / softness) * 255;
                }

                // Despill
                if (alpha > 0 && dist < tolerance + softness + 60) {
                    const factor = Math.max(0, 1 - dist / (tolerance + 100));
                    const gray = r * 0.299 + g * 0.587 + b * 0.114;
                    const str = factor * despill;
                    data[i] = r * (1-str) + gray * str;
                    data[i+1] = g * (1-str) + gray * str;
                    data[i+2] = b * (1-str) + gray * str;
                }

                data[i+3] = Math.round(alpha);
            }

            outputCtx.putImageData(output, 0, 0);

            const format = document.getElementById('outputFormat').value;
            const mime = format === 'webp' ? 'image/webp' : 'image/png';
            
            outputCanvas.toBlob((blob) => {
                resultBlob = blob;
                resultImg.src = URL.createObjectURL(blob);
                document.getElementById('resultInfo').textContent = 
                    `${outputCanvas.width}x${outputCanvas.height} ‚Ä¢ ${(blob.size/1024).toFixed(0)}KB`;
                showResult();
            }, mime, 0.95);
        };

        window.downloadResult = function() {
            if (!resultBlob) return;
            const ext = document.getElementById('outputFormat').value;
            const a = document.createElement('a');
            a.href = URL.createObjectURL(resultBlob);
            a.download = `hasil_nobg.${ext}`;
            a.click();
        };

        window.resetAll = function() {
            currentFile = null;
            resultBlob = null;
            fileInput.value = '';
            uploadZone.style.display = 'block';
            settingsRow.style.display = 'flex';
            progressSection.style.display = 'none';
            resultSection.style.display = 'none';
            pickerCanvas.style.display = 'none';
            document.getElementById('manualControls').classList.add('hidden');
            document.getElementById('manualButtons').classList.add('hidden');
            hideAlerts();
        };

        function showProgress(text) {
            uploadZone.style.display = 'none';
            settingsRow.style.display = 'none';
            resultSection.style.display = 'none';
            progressSection.style.display = 'block';
            progressText.textContent = text;
            progressBar.style.width = '0%';
        }

        function updateProgress(pct, text) {
            progressBar.style.width = pct + '%';
            progressText.textContent = text;
        }

        function hideProgress() {
            progressSection.style.display = 'none';
            uploadZone.style.display = 'block';
            settingsRow.style.display = 'flex';
        }

        function showResult() {
            progressSection.style.display = 'none';
            pickerCanvas.style.display = 'none';
            document.getElementById('manualControls').classList.add('hidden');
            document.getElementById('manualButtons').classList.add('hidden');
            resultSection.style.display = 'block';
        }

        function hexToRgb(hex) {
            const r = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return r ? { r: parseInt(r[1],16), g: parseInt(r[2],16), b: parseInt(r[3],16) } : {r:0,g:0,b:0};
        }

        function showError(msg) {
            alertError.innerHTML = '‚ùå ' + msg;
            alertError.style.display = 'block';
        }

        function showWarning(msg) {
            alertWarning.innerHTML = '‚ö†Ô∏è ' + msg;
            alertWarning.style.display = 'block';
        }

        function hideAlerts() {
            alertError.style.display = 'none';
            alertWarning.style.display = 'none';
        }
    </script>
</body>
</html>
